# Деплой на Netlify

Этот документ содержит инструкции по деплою проекта на Netlify.

## Шаги для деплоя

1. **Подготовка репозитория**

   - Убедитесь, что все изменения закоммичены и отправлены в GitHub
   - Проверьте, что все необходимые файлы включены в репозиторий

2. **Настройка проекта на Netlify**

   - Перейдите на [Netlify](https://app.netlify.com/)
   - Нажмите "Add new site" -> "Import an existing project"
   - Выберите репозиторий из GitHub

3. **Настройки сборки**

   - Build command: `npm run build`
   - Publish directory: `.next`
   - Node version: `18`

4. **Переменные окружения**
   Установите следующие переменные окружения в настройках проекта на Netlify:

   ```
   API_URL=/api
   MONGODB_URI=mongodb+srv://username:password@cluster.mongodb.net/database
   NEXT_TELEMETRY_DISABLED=1
   NEXT_SHARP_PATH=/tmp/node_modules/sharp
   GENERATE_SOURCEMAP=false
   NODE_OPTIONS=--max_old_space_size=4096
   ```

   > **Важно**: Замените `mongodb+srv://username:password@cluster.mongodb.net/database` на реальный URI вашей базы данных MongoDB.

5. **Настройка плагинов**
   - Убедитесь, что плагин `@netlify/plugin-nextjs` установлен и настроен в `netlify.toml`

## Решение проблем при сборке

Если возникают ошибки при сборке:

1. **Проверьте логи сборки** на Netlify для выявления конкретных ошибок

2. **Проблемы с зависимостями**:

   - Убедитесь, что все зависимости указаны в `package.json`
   - Проверьте совместимость версий зависимостей

3. **Проблемы с переменными окружения**:

   - Проверьте, что все необходимые переменные окружения установлены
   - Убедитесь, что формат значений переменных корректный

4. **Проблемы с Next.js**:

   - Убедитесь, что версия Next.js совместима с Netlify
   - Проверьте настройки в `next.config.js`

5. **Проблемы с кэшированием**:
   - Попробуйте очистить кэш сборки на Netlify
   - Запустите сборку с чистого листа

## Оптимизация производительности

1. **Используйте статическую генерацию** (SSG) вместо серверного рендеринга (SSR) где возможно
2. **Оптимизируйте изображения** перед загрузкой
3. **Используйте динамический импорт** для разделения кода
4. **Минимизируйте количество зависимостей**

## Дополнительные ресурсы

- [Документация Netlify по Next.js](https://docs.netlify.com/integrations/frameworks/next-js/)
- [Документация Next.js по деплою](https://nextjs.org/docs/deployment)
- [Оптимизация производительности Next.js](https://nextjs.org/docs/advanced-features/performance)
